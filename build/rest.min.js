!function(){"use strict";function service(config,$http){function load_applicants(selection,filter,page){return url=selection&&"networks"===selection.toLowerCase()?"/applicants/network":"/applicants/channel",request=$http({method:"GET",url:config.api_base_url+url+"?network_id=1&status="+encodeURIComponent(filter)+"&page="+(page||1),ignoreLoadingBar:!0,ignoreGrowl:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function get_all_users(page,search){return request=$http({method:"GET",url:config.api_base_url+"/admin/user_list?page="+page+"&sort=profile_info.fname&search="+encodeURIComponent(search),ignoreLoadingBar:!0,headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function process_application(applicant,type,status){var url="networks"===type.toLowerCase()?"/applicant/network/"+encodeURIComponent(applicant._id):"/applicant/channel/"+applicant._id,request=$http({method:"PUT",url:config.api_base_url+url,ignoreLoadingBar:!0,data:"status="+encodeURIComponent(status),headers:config.custom_headers});return request.then(config.handle_success,config.handle_error)}function load_revshare_changes(page,filter){return request=$http({method:"GET",url:config.api_base_url+"/rev_share?page="+(page||1)+"&filter="+(filter||"approved"),ignoreLoadingBar:!0,headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function process_revshare(share,status){return request=$http({method:"PUT",url:config.api_base_url+"/rev_share",ignoreLoadingBar:!0,data:"_id="+share.entity_id+"&status="+encodeURIComponent(status),headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function get_revshare_applications(filter,limit,offset){return request=$http({method:"GET",url:config.api_base_url+"/rev_share?filter="+filter+"&limit="+limit+"&offset="+offset,ignoreLoadingBar:!0,ignoreGrowl:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function approve_change_revshare(data){return request=$http({method:"PUT",url:config.api_base_url+"/rev_share",ignoreLoadingBar:!0,data:"_id="+data._id+"&approved="+data.approved,ignoreGrowl:!0,headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function change_revshare(data){return request=$http({method:"PUT",url:config.api_base_url+"/admin/rev_share",ignoreLoadingBar:!0,data:"channel_id="+data.channel_id+"&share="+data.share+"&date_effective="+data.date_effective+"&network_id="+data.network_id,ignoreGrowl:!0,headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function export_payout(date,category){return request=$http({method:"GET",url:config.api_base_url+"/earnings/payout?date="+date+"&category="+category,ignoreLoadingBar:!1,ignoreGrowl:!0,headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function payout_dates(){return request=$http({method:"GET",url:config.api_base_url+"/earnings/payout_dates",ignoreLoadingBar:!0,ignoreGrowl:!0,headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function soundcloud_get_artists(page){return request=$http({method:"GET",url:config.api_base_url+"/artists?page="+page,ignoreLoadingBar:!0,headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function soundcloud_add_artists(data){return request=$http({method:"POST",url:config.api_base_url+"/artists",ignoreLoadingBar:!0,data:"id="+data.id+"&username="+data.username+"&uri="+data.uri+"&permalink_url="+data.permalink_url+"&track_count="+data.track_count+"&avatar="+data.avatar_url,headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function soundcloud_remove_artists(artist_id){return request=$http({method:"DELETE",url:config.api_base_url+"/artist/"+artist_id,ignoreLoadingBar:!0,headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function soundcloud_get_new_songs(){}function soundcloud_save_track_to_database(track,copyright_status){var cs="Yes"===copyright_status?1:0;return request=$http({method:"POST",url:config.api_base_url+"/track",ignoreLoadingBar:!0,data:"artist_id="+track.user.id+"&track_id="+track.id+"&track_title="+track.title+"&artist_name="+track.user.username+"&download_count="+track.download_count+"&genre="+track.genre+"&artwork_url="+track.artwork_url+"&downloadable="+track.downloadable+"&download_url="+track.download_url+"&copyright="+cs,headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function get_tracks_from_artist(artist_id,page){return page||(page=1),request=$http({method:"GET",url:config.api_base_url+"/artist/"+artist_id+"/tracks?limit=100&page="+page,ignoreLoadingBar:!0,headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function delete_track_of_artist_from_database(track_id){return request=$http({method:"DELETE",url:config.api_base_url+"/track/"+track_id,ignoreLoadingBar:!0,headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}var request,url="";return{load_applicants:load_applicants,process_application:process_application,get_all_users:get_all_users,load_revshare_changes:load_revshare_changes,process_revshare:process_revshare,get_revshare_applications:get_revshare_applications,approve_change_revshare:approve_change_revshare,change_revshare:change_revshare,export_payout:export_payout,payout_dates:payout_dates,soundcloud_get_artists:soundcloud_get_artists,soundcloud_add_artists:soundcloud_add_artists,soundcloud_remove_artists:soundcloud_remove_artists,soundcloud_get_new_songs:soundcloud_get_new_songs,soundcloud_save_track_to_database:soundcloud_save_track_to_database,get_tracks_from_artist:get_tracks_from_artist,delete_track_of_artist_from_database:delete_track_of_artist_from_database}}angular.module("rest.admin",["rest.config"]).service("adminService",service),service.$inject=["config","$http","$q"]}(),function(){"use strict";function service(config,$http){function get_default_uploads(id){return request=$http.get(config.api_base_url+"/channel/analytics/"+id,config.http_config),config.http_config.ignoreLoadingBar=!0,request.then(config.handle_success,config.handle_error)}function get_default_uploads_videos(id,videoId){return request=$http.get(config.api_base_url+"/channel/analytics/"+id+"/video/"+videoId,config.http_config),config.http_config.ignoreLoadingBar=!0,request.then(config.handle_success,config.handle_error)}function get_dated_uploads(id,sdate,edate){return request=$http.get(config.api_base_url+"/channel/analytics/"+id+"?start_date="+sdate+"&end_date="+edate,config.http_config),config.http_config.ignoreLoadingBar=!0,request.then(config.handle_success,config.handle_error)}function get_default_playlists(channelId,playlistId){return request=$http.get(config.api_base_url+"/channel/analytics/"+channelId+"/playlist/"+playlistId,config.http_config),config.http_config.ignoreLoadingBar=!0,request.then(config.handle_success,config.handle_error)}function get_default_uploads_decoy(link){return request=$http.get(config.api_base_url+link,config.http_config),config.http_config.ignoreLoadingBar=!0,request.then(config.handle_success,config.handle_error)}var request;return{get_default_uploads:get_default_uploads,get_default_uploads_videos:get_default_uploads_videos,get_dated_uploads:get_dated_uploads,get_default_playlists:get_default_playlists,get_default_uploads_decoy:get_default_uploads_decoy}}angular.module("rest.analytics",["rest.config"]).service("analyticsService",service),service.$inject=["config","$http"]}(),angular.module("ui.freedom.rest",["rest.user","rest.channel","rest.network","rest.recruits","rest.admin","rest.points","rest.userearnings","rest.networkearnings","rest.prospects","rest.feed","rest.password","rest.translation","rest.apps","rest.analytics","rest.misc"]).constant("environment",""===public_dir?"development":"production").constant("public_dir",public_dir),function(){"use strict";function service(config,$http){function get_videos_and_playlists(id){return request=$http.get(config.api_base_url+"/channel/"+id+"/videos_and_playlists",config.http_config),config.http_config.ignoreLoadingBar=!0,request.then(config.handle_success,config.handle_error)}function get_videos_and_playlists_with_token_playlist(id,pageToken){return request=$http.get(config.api_base_url+"/channel/"+id+"/videos_and_playlists?playlist_page_token="+pageToken,config.http_config),config.http_config.ignoreLoadingBar=!0,request.then(config.handle_success,config.handle_error)}function get_videos_and_playlists_with_token_videos(id,pageToken){return request=$http.get(config.api_base_url+"/channel/"+id+"/videos_and_playlists?video_page_token="+pageToken,config.http_config),config.http_config.ignoreLoadingBar=!0,request.then(config.handle_success,config.handle_error)}function update_playlist(playlistInformation){return request=$http.put(config.api_base_url+"/channel/"+playlistInformation.channel_id+"/playlist/"+playlistInformation.playlist_id,playlistInformation,config.http_config),config.http_config.ignoreLoadingBar=!0,request.then(config.handle_success,config.handle_error)}function update_video(videoInformation){return request=$http.put(config.api_base_url+"/channel/"+videoInformation.channel_id+"/video/"+videoInformation.video_id,videoInformation,config.http_config),config.http_config.ignoreLoadingBar=!0,request.then(config.handle_success,config.handle_error)}function get_stats_ideal(channelId,startDate,endDate){return request=$http({method:"GET",url:config.api_base_url+"/channel/analytics/"+channelId+"?start_date="+startDate+"&end_date="+endDate+"&format=dddd",ignoreLoadingBar:!1,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function delete_playlist(playlist){return request=$http({method:"DELETE",url:config.api_base_url+"/channel/"+playlist.snippet.channelId+"/playlist/"+playlist.id,ignoreLoadingBar:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function delete_video(video){return request=$http({method:"DELETE",url:config.api_base_url+"/channel/"+video.snippet.channelId+"/video/"+video.id,ignoreLoadingBar:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function get_videos_from_playlist(playlist){return request=$http({method:"GET",url:config.api_base_url+"/playlist/"+playlist.id,ignoreLoadingBar:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function get_videos_from_playlist_with_token(playlist,pageToken){return request=$http({method:"GET",url:config.api_base_url+"/playlist/"+playlist.id+"?page_token="+pageToken,ignoreLoadingBar:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function remove_videos_from_playlist(channelId,videosString){return request=$http({method:"DELETE",url:config.api_base_url+"/channel/"+channelId+"/playlist_item?ids="+videosString,ignoreLoadingBar:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function insert_video_to_playlists(channelId,playlistsString,resource){return request=$http({method:"POST",url:config.api_base_url+"/channel/"+channelId+"/playlist_item?ids="+playlistsString,data:resource,ignoreLoadingBar:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function get_xsplit_count(){return request=$http({method:"GET",url:config.api_base_url+"/sponsorship/xsplit/count",ignoreLoadingBar:!1,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function get_xsplit_code(){return request=$http({method:"POST",url:config.api_base_url+"/sponsorship/xsplit/get_code",ignoreLoadingBar:!1,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function get_xsplit_ext_code(){return request=$http({method:"POST",url:config.api_base_url+"/sponsorship/xsplit/get_code_ext",ignoreLoadingBar:!1,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function get_xsplit_video(){return request=$http({method:"GET",url:config.api_base_url+"/sponsorship/xsplit/has_video_review",ignoreLoadingBar:!1,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function get_xsplit_all_videos(){return request=$http({method:"GET",url:config.api_base_url+"/sponsorship/xsplit/submitted_videos",ignoreLoadingBar:!1,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function update_xsplit_username(username){var data={username:username};return request=$http({method:"PUT",data:data,url:config.api_base_url+"/sponsorship/xsplit/update_username",ignoreLoadingBar:!1,ignoreGrowl:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function submit_xsplit_video(video_id,title,image,campaign_id){var data={video_id:video_id,title:title,image:image,campaign_id:campaign_id};return request=$http({method:"POST",data:data,url:config.api_base_url+"/sponsorship/xsplit/submit_video_review",ignoreLoadingBar:!1,ignoreGrowl:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function set_xsplit_video_status(status,user_id,video_id){var data={status:status,user_id:user_id,video_id:video_id};return request=$http({method:"PUT",data:data,url:config.api_base_url+"/sponsorship/xsplit/video_status",ignoreLoadingBar:!1,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function apply_sponsorship(data){return request=$http({method:"POST",data:data,url:config.api_base_url+"/sponsorship",ignoreLoadingBar:!1,ignoreGrowl:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function get_channel_spotlights(){return request=$http({method:"GET",url:"https://www.googleapis.com/youtube/v3/playlistItems?part=id%2C+snippet&maxResults=50&playlistId=PLxLYo5_7D3ScpQSJC74FENcBE25hlDE78&key=AIzaSyDqWOahd3OSYfctw5pTTcNjQjjfD3QC-s4",ignoreLoadingBar:!1,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function get_promises(){return request=$http({method:"GET",url:config.api_base_url+"/promises",ignoreLoadingBar:!1,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function delete_request(id){return request=$http({method:"DELETE",url:config.api_base_url+"/promise/"+id,ignoreLoadingBar:!1,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function update_request(id,requestTitle,requestBody){var data={title:requestTitle,body:requestBody};return request=$http({method:"PUT",data:data,url:config.api_base_url+"/promise/"+id,ignoreLoadingBar:!1,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function accept_request(id,fullname,name,status){var data={accepted_by:fullname,name:name,status:status};return request=$http({method:"PUT",data:data,url:config.api_base_url+"/promise/"+id,ignoreLoadingBar:!1,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function submit_request(name,requestTitle,requestBody){var data={name:name,title:requestTitle,body:requestBody};return request=$http({method:"POST",data:data,url:config.api_base_url+"/promise",ignoreLoadingBar:!1,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function get_sponsorship_categories(){return request=$http({method:"GET",url:config.api_base_url+"/sponsorship/categories/",ignoreLoadingBar:!1,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function get_sponsorship_applications(status,category){var url;return url=status?config.api_base_url+"/sponsorship/applications?status="+status:category?config.api_base_url+"/sponsorship/applications?category="+category:category&&status?config.api_base_url+"/sponsorship/applications?status="+status+"&category="+category:config.api_base_url+"/sponsorship/applications",request=$http({method:"GET",url:url,ignoreLoadingBar:!1,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function change_application_status(status,category,channel_id){var data={status:status,category:category,channel_id:channel_id};return request=$http({method:"PUT",data:data,url:config.api_base_url+"/sponsorship/status",ignoreLoadingBar:!1,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function get_videos_onbid(){return request=$http({method:"GET",url:config.api_base_url+"/points/vids",ignoreLoadingBar:!1,ignoreGrowl:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function bid_on_video(bid,video_id){var data={bid:bid,video_id:video_id};return request=$http({method:"PUT",data:data,url:config.api_base_url+"/points/bid",ignoreLoadingBar:!1,ignoreGrowl:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}var request;return{get_videos_and_playlists:get_videos_and_playlists,get_videos_and_playlists_with_token_playlist:get_videos_and_playlists_with_token_playlist,get_videos_and_playlists_with_token_videos:get_videos_and_playlists_with_token_videos,update_playlist:update_playlist,update_video:update_video,get_stats_ideal:get_stats_ideal,delete_video:delete_video,delete_playlist:delete_playlist,get_videos_from_playlist:get_videos_from_playlist,get_videos_from_playlist_with_token:get_videos_from_playlist_with_token,remove_videos_from_playlist:remove_videos_from_playlist,insert_video_to_playlists:insert_video_to_playlists,get_xsplit_count:get_xsplit_count,get_xsplit_code:get_xsplit_code,get_xsplit_ext_code:get_xsplit_ext_code,get_xsplit_video:get_xsplit_video,get_xsplit_all_videos:get_xsplit_all_videos,update_xsplit_username:update_xsplit_username,submit_xsplit_video:submit_xsplit_video,set_xsplit_video_status:set_xsplit_video_status,apply_sponsorship:apply_sponsorship,get_channel_spotlights:get_channel_spotlights,get_promises:get_promises,delete_request:delete_request,update_request:update_request,accept_request:accept_request,submit_request:submit_request,get_sponsorship_categories:get_sponsorship_categories,get_sponsorship_applications:get_sponsorship_applications,change_application_status:change_application_status,get_videos_onbid:get_videos_onbid,bid_on_video:bid_on_video}}angular.module("rest.apps",["rest.config"]).service("appsService",service),service.$inject=["config","$http","$q"]}(),function(){"use strict";function service(config,$http,$q,localStorageService,Earnings){function get_live(id,part){return request=$http({method:"GET",url:config.api_base_url+"/channels?ids="+id+"&part="+part,ignoreLoadingBar:!0,ignoreGrowl:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function get_channel_analytics(id){return request=$http.get(config.api_base_url+"/channel/analytics/"+id,config.http_config),config.http_config.ignoreLoadingBar=!0,request.then(config.handle_success,config.handle_error)}function get_channel_stats(id,filter,network_id){var url="";return url=network_id?config.api_base_url+"/channel/mini_analytics/"+id+"?network_id="+network_id+"&filter="+filter:config.api_base_url+"/channel/mini_analytics/"+id+"?filter="+filter,request=$http({method:"GET",url:url,ignoreLoadingBar:!0,ignoreGrowl:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function get(id){var channels=temp_data.data;return temp_data=localStorageService.get("c#"+config.api_key())||[],deferred=$q.defer(),channels?angular.forEach(channels,function(temp){return temp.id===id?void deferred.resolve(temp):void 0}):get_live(id,"network,statistics,basic").then(function(channel){temp_data[channel.id]=channel,localStorageService.set("c#"+config.api_key(),temp_data),deferred.resolve(temp_data[channel.id])},function(){deferred.reject(null)}),deferred.promise}function add(_channels_csv,status,isAdmin){var deferred=$q.defer();return get_live(_channels_csv,"network,statistics,basic,rev_share").then(function(res){var channel_arr=localStorageService.get("c#"+config.api_key())||[];isAdmin&&(channel_arr=[]),angular.forEach(res,function(channel){channel.status=status,channel.total_comments=parseFloat(channel.total_comments||0),channel.total_subscribers=parseFloat(channel.total_subscribers||0),channel.total_videos=parseFloat(channel.total_videos||0),channel.total_views=parseFloat(channel.total_views||0),channel.has_error=!1,channel_arr.push(channel),isAdmin?localStorageService.set("ac#"+config.api_key(),channel_arr):localStorageService.set("c#"+config.api_key(),channel_arr)}),deferred.resolve(channel_arr)},function(res){var channel_arr=localStorageService.get("c#"+config.api_key())||[];angular.forEach(res,function(channel){"getaddrinfo ENOTFOUND"===channel.message?channel.status="backend_error":"unauthorized_client"===channel.error||"invalid_grant"===channel.error?channel.error="reauth":"Channel not found using youtube API"===channel?(channel={},channel.error="takendown"):channel={},channel.has_error=!0,channel_arr.push(channel),localStorageService.set("c#"+config.api_key(),channel_arr)}),deferred.reject(channel_arr)}),deferred.promise}function clear(){return temp_data=localStorageService.remove("c#"+config.api_key()),console.log("clear",localStorageService.get("c#"+config.api_key()),temp_data),temp_data}function unpartner_channel(id){return request=$http({method:"DELETE",url:config.api_base_url+"/channel/"+id,ignoreLoadingBar:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function accept_contract(){var url=config.api_base_url+"/accept_partnership_contract";return request=$http({method:"POST",url:url,data:{},headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}var request,deferred,temp_data;return{get_live:get_live,get_channel_analytics:get_channel_analytics,get_channel_stats:get_channel_stats,get:get,add:add,unpartner_channel:unpartner_channel,accept_contract:accept_contract,clear:clear}}angular.module("rest.channel",["rest.config"]).service("channelService",service),service.$inject=["config","$http","$q","localStorageService","Earnings"]}(),function(){"use strict";function config($cookies,$q,localStorageService,settings){function api_key(){var sandbox=localStorageService.get("current_sandbox");return val=$cookies.access_token,sandbox&&(val=sandbox.access_token||"currentbox"),val?val:null}function handle_error(response){return angular.isObject(response.data)&&response.data.message?$q.reject(response.data.message):(validate_token(response),response.data,$q.reject("An unknown error occurred."))}function handle_success(res){return res.data}function validate_token(res){return"invalid_grant"===res.data.message?!0:!1}var val;return{base_url:settings.base_url,api_base_url:settings.api_url,headers:{"X-ACCESS-TOKEN":api_key()},custom_headers:{"X-ACCESS-TOKEN":api_key(),"Content-Type":"application/x-www-form-urlencoded"},http_config:{headers:{"X-ACCESS-TOKEN":api_key()}},api_key:api_key,handle_error:handle_error,validate_token:validate_token,handle_success:handle_success}}angular.module("rest.config",[]).service("config",config),config.$inject=["$cookies","$q","localStorageService","settings","$http"]}(),function(){"use strict";function service(config,$http){function get(){return request=$http.get(config.api_base_url+"/feed",config.http_config),request.then(config.handle_success,config.handle_error)}function add_announcement(an){return data={feed:an},request=$http({method:"POST",url:config.api_base_url+"/network/feed",data:data,ignoreLoadingBar:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function get_announcements(){return request=$http({method:"GET",url:config.api_base_url+"/network/feed",ignoreLoadingBar:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function delete_announcement(id){return request=$http({method:"DELETE",url:config.api_base_url+"/network/feed/"+id,ignoreLoadingBar:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}var request,data;return{add_announcement:add_announcement,delete_announcement:delete_announcement,get_announcements:get_announcements,get:get}}angular.module("rest.feed",["rest.config"]).service("feedService",service),service.$inject=["config","$http","$q"]}(),function(){"use strict";function service(config,$http){function get_countries(){return request=$http.get("http://restcountries.eu/rest/v1"),request.then(config.handle_success,config.handle_error)}var request;return{get_countries:get_countries}}angular.module("rest.misc",["rest.config"]).service("helpers",service),service.$inject=["config","$http","$q"]}(),function(){"use strict";function service(config,userService,localStorageService,$http,$q){function view_members(network_id,search,page,limit,sortby){return search?(request=$http({method:"GET",ignoreLoadingBar:!0,url:config.api_base_url+"/network/channel_search?network_id="+network_id+"&key="+encodeURIComponent(search),headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)):(url="?network_id="+network_id+"&order="+sortby||"total_views",url+=page&&"&page="+page||"",limit&&(url+="&limit="+limit),request=$http({method:"GET",ignoreLoadingBar:!0,url:config.api_base_url+"/network/channels"+url,headers:config.custom_headers}),request.then(config.handle_success,config.handle_error))}function get_applicants(network_id,status){return request=$http.get(config.api_base_url+"/applicants/channel?network_id="+network_id+"&status="+status,config.http_config),request.then(config.handle_success,config.handle_error)}function edit_application_status(channel_id,status){var data="accept"==status?{status:"Accepted"}:"reject"==status?{status:"Rejected"}:{status:"Pending"};return data.ids=[],"string"==typeof channel_id?data.ids=channel_id:channel_id&&channel_id.length&&(data.ids=channel_id.join()),request=$http.put(config.api_base_url+"/applicant/channel",data,config.http_config),request.then(config.handleSuccess,config.handleError)}function get_partners(id,page){return request=$http.get(config.api_base_url+"/network/channels?id="+id+"&page="+page,config.http_config),request.then(config.handleSuccess,config.handleError)}function get_current_networks(){var deferred=$q.defer();return userService.get().then(function(res){if(res&&res.app_data&&res.app_data.channels_owned){var ch_ow=res.app_data.channels_owned,network_ids=[];ch_ow.filter(function(elem){elem&&elem.network_id&&!~network_ids.indexOf(elem.network_id)&&network_ids.push(elem.network_id)}),console.log("network_ids",network_ids),deferred.resolve(network_ids)}else deferred.reject(null)}),deferred.promise}function get_selected_network(real){var len=0,network_id=null,user=null,deferred=$q.defer();return userService.get().then(function(res){if(user=res,user.networks&&user.networks.length)if(console.log("user.networks get_selected_network",user.networks),localStorageService.get("sn#"+config.api_key())?network_id=localStorageService.get("sn#"+config.api_key()):(localStorageService.set("sn#"+config.api_key(),user.networks[0]._id),network_id=user.networks[0]._id),len=user.networks.length,real)get(network_id,!1).then(function(real_network){real_network.landing_page_styles=JSON.parse(real_network.landing_page_styles),deferred.resolve(real_network)});else{for(var i=0;len>i;i++)user.networks[i]._id===parseInt(network_id)&&deferred.resolve(user.networks[i]);deferred.resolve(1)}else deferred.resolve(2)},function(){deferred.reject(3)}),deferred.promise}function get(id,public_access){return request=null,public_access?(console.log("config.api_base_url id",config.api_base_url+"/network/"+id),request=$http.get(config.api_base_url+"/network/"+id)):(console.log("config.api_base_url id"+id,config.http_config),request=$http.get(config.api_base_url+"/network/"+id,config.http_config)),request.then(config.handle_success,config.handle_error)}function update(id,edited){return request=$http.put(config.api_base_url+"/network/"+id,edited,config.http_config),request.then(config.handle_success,config.handle_error)}function export_csv(){return request=$http.get(config.api_base_url+"/network/csv",config.http_config),request.then(config.handle_success,config.handle_error)}function apply_revshare(data){return request=$http({method:"POST",url:config.api_base_url+"/apply/rev_share",data:data,ignoreLoadingBar:!0,ignoreGrowl:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function apply_sponsorship(data){return request=$http({method:"POST",url:config.api_base_url+"/network/sponsored",data:data,ignoreLoadingBar:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function get_sponsor_applicants(id,filters){var params="?";return params+="limit="+filters.limit+"&",params+="offset="+filters.offset+"&",params+="filter="+filters.filter+"&",params+="sort="+filters.sort,request=$http({method:"GET",url:config.api_base_url+"/network/sponsored/"+id+params,ignoreLoadingBar:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function get_sponsor_applicants_admin(filters){var params="?";return params+="page="+filters.page+"&",params+="filter="+filters.filter+"&",params+="sort="+filters.sort,request=$http({method:"GET",url:config.api_base_url+"/admin/sponsored_network"+params,ignoreLoadingBar:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function update_sponsors_status(data){return request=$http({method:"POST",url:config.api_base_url+"/network/accept_sponsor",data:data,ignoreLoadingBar:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function get_spotlight(id){return request=$http({method:"GET",url:config.api_base_url+"/spotlight?network_id="+id,ignoreLoadingBar:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function update_spotlight(id,array_of_url,array_of_channels){return request=$http({method:"POST",url:config.api_base_url+"/spotlight",data:{network_id:id,playlists:array_of_url,channels:array_of_channels},ignoreLoadingBar:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function get_networks(page,search){return request=$http({method:"GET",url:config.api_base_url+"/networks?key="+search+"&page="+page,ignoreLoadingBar:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function move_to_network(channel_id,user_id,to,from){return request=$http({method:"POST",url:config.api_base_url+"/admin/move_channel_network",data:{channel_id:channel_id,_id:user_id,to:to,from:from},ignoreLoadingBar:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function sponsored_networks(network_id,filter,sort,page){return request=$http({method:"GET",url:config.api_base_url+"/network/sponsored/"+network_id+"?filter="+filter.toLowerCase()+"&sort="+sort+"&page="+page,ignoreLoadingBar:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}var request,url;return{get_applicants:get_applicants,edit_application_status:edit_application_status,view_members:view_members,update:update,get_partners:get_partners,get_current_networks:get_current_networks,get:get,export_csv:export_csv,apply_revshare:apply_revshare,get_selected_network:get_selected_network,apply_sponsorship:apply_sponsorship,get_sponsor_applicants:get_sponsor_applicants,get_sponsor_applicants_admin:get_sponsor_applicants_admin,update_sponsors_status:update_sponsors_status,get_spotlight:get_spotlight,get_networks:get_networks,move_to_network:move_to_network,sponsored_networks:sponsored_networks,update_spotlight:update_spotlight}
}angular.module("rest.network",["rest.config","rest.user"]).service("networkService",service),service.$inject=["config","userService","localStorageService","$http","$q"]}(),function(){"use strict";function service(config,$http){function call_range(){return request=$http({method:"GET",url:config.api_base_url+"/earnings/date_range",headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function get_report_from_date(list_reports){return request=$http({method:"GET",url:config.api_base_url+"/earnings/network?report_id="+encodeURIComponent(list_reports),headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function get_details(list_reports){return request=$http({method:"GET",url:config.api_base_url+"/earnings/network/details?report_id="+encodeURIComponent(list_reports),headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function search_channels(key){return request=$http({method:"GET",url:config.api_base_url+"/earnings/network/details?channel_id="+encodeURIComponent(key),headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function search_users(id,list_reports){return request=$http({method:"GET",url:config.api_base_url+"/earnings/network?report_id="+encodeURIComponent(list_reports)+"&user_id="+encodeURIComponent(id),headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}var request;return{call_range:call_range,get_details:get_details,search_users:search_users,search_channels:search_channels,get_report_from_date:get_report_from_date}}angular.module("rest.networkearnings",["rest.config"]).service("networkearningsService",service),service.$inject=["config","$http"]}(),function(){"use strict";function service(config,$http){function submit_change(_email,_password,_reset_token){return data={email:_email,password:_password,reset_token:_reset_token},request=config.api_key()?$http.post(config.api_base_url+"/reset_password",data,config.http_config):$http.post(config.api_base_url+"/reset_password",data),request.then(config.handle_success,config.handle_error)}function request_change(email){return request=config.api_key()?$http.get(config.api_base_url+"/send_reset_mail?email="+email,config.http_config):$http.get(config.api_base_url+"/send_reset_mail?email="+email),request.then(config.handle_success,config.handle_error)}var request,data;return{submit_change:submit_change,request_change:request_change}}angular.module("rest.password",["rest.config"]).service("passwordService",service),service.$inject=["config","$http","$q"]}(),function(){"use strict";function factory(pointsService,localStorageService,$rootScope,$q){function get_points(fresh){return defer=$q.defer(),points.fp=localStorageService.get($rootScope.access_token+"points"),is_empty(points.fp)?pointsService.get_points(fresh).then(function(data){localStorageService.set($rootScope.access_token+"points",data),points.fp=data,defer.resolve(data)},function(){defer.reject({points:0})}):defer.resolve(points.fp),defer.promise}var defer,points={get_points:get_points};return points}angular.module("ui.freedom").factory("Points",factory),factory.$inject=["pointsService","localStorageService","$rootScope","$q"]}(),function(){"use strict";function service(config,$http){function compute_growth(fast){return request=$http({method:"PUT",url:config.api_base_url+"/points/compute"+(fast?"?saved=true":""),ignoreLoadingBar:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function register_event(event){return data={name:event},request=$http({method:"GET",url:config.api_base_url+"/register_event",data:data,headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function connect_forum(username,password){return request=$http({method:"PUT",url:config.api_base_url+"/points/forum",data:"username="+username+"&password="+password,headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function get_username(){return request=$http({method:"GET",url:config.api_base_url+"/username?app=forum",headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function get_transaction(accomplishment){return request=$http({method:"GET",url:config.api_base_url+"/points/transaction?accomplishment="+encodeURIComponent(accomplishment),headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function upsert_username(username){return request=$http({method:"POST",url:config.api_base_url+"/username",data:"app=forum&username="+encodeURIComponent(username),headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}var request,data;return{compute_growth:compute_growth,connect_forum:connect_forum,upsert_username:upsert_username,get_username:get_username,get_transaction:get_transaction,register_event:register_event}}angular.module("rest.points",["rest.config"]).service("pointsService",service),service.$inject=["config","$http","$q"]}(),function(){"use strict";function service(config,$http){function search(key){return request=$http({method:"GET",url:config.api_base_url+"/prospect/search/"+key,ignoreLoadingBar:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function add_prospects(prospect){return data={username:prospect.snippet.title,owner:prospect.snippet.title,thumbnail:prospect.snippet.thumbnails["default"].url},request=$http({method:"POST",url:config.api_base_url+"/prospect/",data:data,ignoreLoadingBar:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function update_status(item){return request=$http({method:"PUT",ignoreLoadingBar:!0,url:config.api_base_url+"/prospect/"+encodeURIComponent(item._id),data:"status="+item.status+"&note="+item.note,headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function view_prospects(){return request=$http({method:"GET",ignoreLoadingBar:!0,url:config.api_base_url+"/prospects/",headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function remove_prospects(prospect){return request=$http({method:"DELETE",ignoreLoadingBar:!0,url:config.api_base_url+"/prospects",data:"ids="+prospect._id,headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function network_prospects(page){var url="?limit=25&page="+(page||0);return request=$http({method:"GET",url:config.api_base_url+"/network/recruited_by_recruiters"+url,ignoreLoadingBar:!0,ignoreGrowl:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}var request,data;return{search:search,add_prospects:add_prospects,update_status:update_status,view_prospects:view_prospects,network_prospects:network_prospects,remove_prospects:remove_prospects}}angular.module("rest.prospects",["rest.config"]).service("prospectsService",service),service.$inject=["config","$http","$q"]}(),function(){"use strict";function service(config,$http){function load_recruits_users(){return request=$http({method:"GET",url:config.api_base_url+"/recruits",ignoreLoadingBar:!0,ignoreGrowl:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function load_recruits_channels(){return request=$http({method:"GET",url:config.api_base_url+"/recruits?has_channels=1",ignoreLoadingBar:!0,ignoreGrowl:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function overall_recruiters(page,sort){var url="?page="+page||"0&order="+sort||"total";return request=$http({method:"GET",url:config.api_base_url+"/recruiters"+url,ignoreLoadingBar:!0,ignoreGrowl:!0,headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function network_recruiters(page,sort,network_id){var url="?page="+(page||0)+"&order="+(sort||"total");return request=$http({method:"GET",url:config.api_base_url+"/recruiters"+url+"&network_id="+network_id,ignoreLoadingBar:!0,ignoreGrowl:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function get_recruiter_commission(csv_ids){return request=$http({method:"GET",url:config.api_base_url+"/admin/recruiter_commission?ids="+csv_ids,ignoreLoadingBar:!0,ignoreGrowl:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function save_recruiter_commission(commission){return request=$http({method:"POST",url:config.api_base_url+"/admin/recruiter_commission",data:commission,ignoreLoadingBar:!0,ignoreGrowl:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}var request;return{load_recruits_users:load_recruits_users,load_recruits_channels:load_recruits_channels,network_recruiters:network_recruiters,overall_recruiters:overall_recruiters,get_recruiter_commission:get_recruiter_commission,save_recruiter_commission:save_recruiter_commission}}angular.module("rest.recruits",["rest.config"]).service("recruitsService",service),service.$inject=["config","$http","$q"]}(),function(){"use strict";function factory(userService,localStorageService,$rootScope,$q,$window,$cookies){function add(id){return defer=$q.defer(),userService.get_user(id).then(function(user){user.isInformed=!1,sessions.current_sandbox=localStorageService.get("current_sandbox"),userService.get_token(user).then(function(data){user.access_token=data.user_access_token||data,boxes.push(user),localStorageService.set("boxes",boxes),localStorageService.set("sandbox_"+id,user),localStorageService.set("current_sandbox",user),defer.resolve(user)},function(err){console.log("failed",err),defer.reject(user)})}),defer.promise}function remove(id){sessions.current_sandbox=!1;var boxes=localStorageService.get("boxes");return localStorageService.clearAll(),localStorageService.set("boxes",boxes),localStorageService.remove("sandbox_"+id)}function change(box){var boxes=localStorageService.get("boxes");return console.log("   boxes",boxes),localStorageService.clearAll(),localStorageService.set("sandbox_"+box._id,box),localStorageService.set("boxes",boxes),localStorageService.set("u#"+box.access_token,box),localStorageService.set("current_sandbox",box)}function get_current_sandbox(){return localStorageService.get("current_sandbox")}function get_sandboxes(){return localStorageService.get("boxes")||[]}function update_current_sandbox(data){return localStorageService.set("current_sandbox",data)}var defer,boxes=localStorageService.get("boxes")||[],sessions=(localStorageService.get("num_of_boxes")||0,{current_sandbox:!1,add:add,remove:remove,change:change,update_current_sandbox:update_current_sandbox,get_current_sandbox:get_current_sandbox,get_sandboxes:get_sandboxes});return sessions}angular.module("ui.freedom").factory("Sessions",factory),factory.$inject=["userService","localStorageService","$rootScope","$q","$window","$cookies"]}(),function(){function translator(config,$http,settings){function parse_json(data){for(var entry=data.data.feed.entry,json={},i=entry.length-1;i>=0;i--)json[entry[i].gsx$key.$t]=""===entry[i].gsx$value.$t&&entry[i].gsx$key.$t||entry[i].gsx$value.$t;return json}var request,key;return function(options){return key=settings.languages[options.key.toLowerCase()]&&settings.languages[options.key.toLowerCase()].key||settings.languages.en.key,request=$http({method:"GET",url:"https://spreadsheets.google.com/feeds/list/"+key+"/od6/public/values?alt=json"}),request.then(parse_json,config.handle_error)}}angular.module("rest.translation",["rest.config"]).service("translationService",translator),translator.$inject=["config","$http","settings"]}(),function(){function service(config,$http,$q,localStorageService){function get_live(){return request=$http.get(config.api_base_url+"/user",config.http_config),request.then(config.handle_success,config.handle_error)}function get_user(id){return request=$http.get(config.api_base_url+"/user/"+id,config.http_config),request.then(config.handle_success,config.handle_error)}function get_test(){return request=$http.get(config.api_base_url+"/user",config.http_config)}function update_basic(data){return request=$http.put(config.api_base_url+"/user",data,config.http_config),request.then(config.handle_success,config.handle_error)}function confirm_user(_email,_password){return data={email:_email,password:_password},request=$http.post(config.api_base_url+"/login?confirmation=1",data,config.http_config),request.then(config.handle_success,config.handle_error)}function get_summary(id){return request=$http(id?{method:"GET",url:config.api_base_url+"/summary?network_id="+id,ignoreLoadingBar:!0,headers:config.http_config.headers}:{method:"GET",url:config.api_base_url+"/summary",ignoreLoadingBar:!0,headers:config.http_config.headers}),request.then(config.handle_success,config.handle_error)}function get(refresh){var deferred=$q.defer(),temp_data=localStorageService.get("u#"+config.api_key()),current_sandbox=localStorageService.get("current_sandbox");return current_sandbox&&(temp_data=current_sandbox),temp_data&&!refresh?deferred.resolve(temp_data):get_live().then(function(user_instance){localStorageService.set("u#"+config.api_key(),user_instance),deferred.resolve(user_instance)},function(res){console.log("error",res),deferred.reject(null)}),deferred.promise}function set_local(user){return user?(localStorageService.set("u#"+config.api_key(),user),!0):!1}function submit_spotlight_vid(video_id,reason){return request=$http({method:"POST",url:config.api_base_url+"/points/spotlight_vid",data:"video_id="+video_id+"&reason="+reason,ignoreLoadingBar:!0,ignoreGrowl:!0,headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function get_token(sandbox){return request=$http({method:"POST",url:config.api_base_url+"/admin/view_as",data:"user_id="+encodeURIComponent(sandbox._id)+"&roles="+sandbox.app_data.roles.join(","),headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function delete_channel(channel){return request=$http({method:"DELETE",url:config.api_base_url+"/channel/"+encodeURIComponent(channel._id),headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function get_logs(page){var url="?page="+(page?page:1);return request=$http({method:"GET",url:config.api_base_url+"/logs"+url,headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function login_as(){}var request,data;return{get_live:get_live,get_test:get_test,update_basic:update_basic,confirm_user:confirm_user,get_summary:get_summary,set:set_local,get_token:get_token,get:get,get_user:get_user,login_as:login_as,get_logs:get_logs,delete_channel:delete_channel,submit_spotlight_vid:submit_spotlight_vid}}angular.module("rest.user",["rest.config"]).service("userService",service),service.$inject=["config","$http","$q","localStorageService"]}(),function(){"use strict";function factory(userearningsService,networkearningsService,localStorageService,$rootScope,$q){function get_reports(refresh){return defer=$q.defer(),earnings.reports=localStorageService.get($rootScope.access_token+"reports"),is_empty(earnings.reports)||refresh?userearningsService.call_range().then(function(data){console.log("   data",data),earnings.reports=data,localStorageService.set($rootScope.access_token+"reports",data),initialize(),defer.resolve(data)},function(data){defer.reject(data)}):(initialize(),defer.resolve(earnings.reports)),defer.promise}function get_raw_reports(refresh){return defer=$q.defer(),earnings.reports=localStorageService.get($rootScope.access_token+"reports"),is_empty(earnings.reports)||refresh?userearningsService.call_range(!0).then(function(data){console.log("   data",data),earnings.reports=data,localStorageService.set($rootScope.access_token+"reports",data),initialize(),defer.resolve(data)},function(data){defer.reject(data)}):(initialize(),defer.resolve(earnings.reports)),defer.promise}function get_channel_earnings(refresh){return defer=$q.defer(),earnings.channel_earnings=localStorageService.get($rootScope.access_token+"earnings"),is_empty(earnings.channel_earnings)||refresh?(earnings.channel_earnings=earnings.raw_channel_earnings,localStorageService.set($rootScope.access_token+"earnings",earnings.channel_earnings),channel_map_earnings(earnings.channel_earnings,!1),defer.resolve(earnings.channel_earnings)):(channel_map_earnings(earnings.channel_earnings,!1),defer.resolve(earnings.channel_earnings)),defer.promise}function get_user_earnings(id){return defer=$q.defer(),userearningsService.get_user_earnings(id,earnings.list_reports).then(function(data){earnings.raw_channel_earnings=data,channel_map_earnings(earnings.raw_channel_earnings,!1),defer.resolve(earnings.raw_channel_earnings)},function(data){defer.reject(data)}),defer.promise}function initialize(){earnings.list_reports="",earnings.list_reports_limited="",earnings.start=earnings.reports[earnings.reports.length-1],earnings.latest=earnings.reports[0],earnings.reports_mapping={};for(var ctr=0,i=earnings.reports.length-1;i>=0;i--)earnings.list_reports+=earnings.reports[i].id+",",12>ctr&&(earnings.list_reports_limited+=earnings.reports[i].id+","),earnings.reports_mapping[earnings.reports[i].id]={start_date:earnings.reports[i].start_date,end_date:earnings.reports[i].date},ctr++}function get_current_earnings(){return defer=$q.defer(),earnings.channel_earnings=localStorageService.get($rootScope.access_token+"current_earnings"),console.log("   earnings.channel_earnings",earnings.channel_earnings),is_empty(earnings.channel_earnings)?earnings.latest?userearningsService.get_report_from_date(earnings.latest.id).then(function(data){earnings.channel_earnings=data,localStorageService.set($rootScope.access_token+"current_earnings",data),channel_map_earnings(data,!1),earnings.current_earnings={month:get_month(earnings.latest.start_date),earnings:earnings.maps.date_map[earnings.latest.start_date].total},defer.resolve(earnings.current_earnings)},function(data){defer.reject(data)}):defer.reject({}):(channel_map_earnings(earnings.channel_earnings,!1),earnings.current_earnings={month:get_month(earnings.latest.start_date),earnings:earnings.maps.date_map[earnings.latest.start_date].total},defer.resolve(earnings.current_earnings)),defer.promise}function get_raw_earnings(){return defer=$q.defer(),earnings.raw_channel_earnings=localStorageService.get($rootScope.access_token+"rawearnings"),is_empty(earnings.raw_channel_earnings)?userearningsService.get_report_from_date(earnings.list_reports).then(function(data){earnings.raw_channel_earnings=data,localStorageService.set($rootScope.access_token+"rawearnings",data),channel_map_earnings(earnings.raw_channel_earnings,1),defer.resolve(earnings.raw_channel_earnings)},function(data){defer.reject(data)}):(channel_map_earnings(earnings.raw_channel_earnings,1),defer.resolve(earnings.raw_channel_earnings)),defer.promise}function set_list_reports(start,after,year){var d,i,reports_to_search="",diff=start-year,big=diff>0?start:after,small=0>diff?start:after,ctr=small,ch_earnings=earnings.raw_channel_earnings,reports=earnings.reports;for(earnings.channel_earnings={};big>=ctr;){for(i in reports)d=year+"-"+pad2(parseInt(ctr))+"-01",reports[i].start_date===d&&(reports_to_search+=reports[i].id+",",earnings.channel_earnings[reports[i].id]=ch_earnings[reports[i].id]);ctr++}localStorageService.set($rootScope.access_token+"earnings",earnings.channel_earnings),earnings.reports_to_search=reports_to_search,channel_map_earnings(earnings.channel_earnings,!1)}function channel_map_earnings(earn,raw){console.log(" channel_map_earnings  earn",is_empty(earn));var key,i,obj,id,net_earnings,ch_earnings,revshare,maps={details_map:{},channel_map:{},date_map:{},total:0};if(is_empty(earn))return earnings.channel_chart_data=!1,void(earnings[raw?"raw_maps":"maps"]=maps);earnings.start_selection=0,earnings.end_selection=0;for(key in earn)for(0===earnings.start_selection&&(earnings.start_selection=earn[key]),maps.date_map[earn[key].start_date]={total:0},i=earn[key].earnings.length-1;i>=0;i--)obj=earn[key].earnings[i],id=obj.user_channel_id,ch_earnings=obj.earnings,revshare=obj.revenue_share&&obj.revenue_share.revenue_share?obj.revenue_share.revenue_share:0,net_earnings=ch_earnings*(revshare/100),maps.channel_map.hasOwnProperty(id)?maps.channel_map[id][earn[key].start_date]=net_earnings:(maps.channel_map[id]={total:0},maps.channel_map[id][earn[key].start_date]=net_earnings),maps.channel_map[id].total+=net_earnings,maps.details_map[id]=obj,maps.date_map[earn[key].start_date][id]=net_earnings,maps.date_map[earn[key].start_date].total+=net_earnings,maps.total+=net_earnings;earnings.end_selection=earn[key],console.log("   maps",maps),earnings[raw?"raw_maps":"maps"]=maps,format_to_chart(maps)}function format_to_chart(maps){var data=[["Months","-All Channels-"]],array_to_add=[],length=1,c=0,ctr=0,details_map=maps.details_map,date_map=maps.date_map;earnings.indexMap={1:"-All Channels-"};for(var a in details_map)earnings.indexMap[length+1]=details_map[a].user_channel_id,data[0].push(details_map[a].channel_display_name),length++;ctr=0;for(var i in date_map){for(array_to_add=[get_month(i),0],c=2;c<data[0].length;c++)maps.channel_map[earnings.indexMap[c]].hasOwnProperty(i)?(array_to_add.push(maps.channel_map[earnings.indexMap[c]][i]),ctr+=maps.channel_map[earnings.indexMap[c]][i]):array_to_add.push(0);array_to_add[1]=ctr,ctr=0,data.push(array_to_add)}earnings.channel_chart_data=data}function get_raw_network_earnings(){return defer=$q.defer(),earnings.raw_network_earnings=localStorageService.get($rootScope.access_token+"rawnetearnings"),is_empty(earnings.raw_network_earnings)?networkearningsService.get_report_from_date(earnings.list_reports).then(function(data){earnings.raw_network_earnings=data,localStorageService.set($rootScope.access_token+"rawnetearnings",data),raw_network_mapping(earnings.raw_network_earnings),defer.resolve(earnings.raw_network_earnings)},function(data){defer.reject(data)}):(raw_network_mapping(earnings.raw_network_earnings),defer.resolve(earnings.raw_network_earnings)),defer.promise}function raw_network_mapping(earn){earnings.raw_network_maps={reports_mapping:{}},is_empty(earn)||(earnings.latest=earnings.reports_mapping[earn[earn.length-1].report_id||0],earnings.start=earnings.reports_mapping[earn[0].report_id]),earnings.net_earnings={total:0,current:0,next:0};for(var i=0;i<earn.length;i++)earnings.net_earnings.total+=earn[i].earnings,earnings.net_earnings.current=earn[i].earnings,earnings.raw_network_maps.reports_mapping[earn[i].report_id]=earn[i],earnings.raw_network_maps.reports_mapping[earn[i].report_id].start_date=earnings.reports_mapping[earn[i].report_id].start_date;earnings.net_earnings.next=earnings.net_earnings.total/earn.length}function change_reports(start,after,year){console.log("   start",start),console.log("   after",after);var d,i,reports_to_search="",diff=start-year,big=diff>0?start:after,small=0>diff?start:after,reports=earnings.reports,ctr=small;for(earnings.net_earnings={},console.log("   reports",reports),console.log("   small ",small),console.log("   big",big),console.log("   earnings.raw_network_earnings",earnings.raw_network_earnings);big>=ctr;){for(i in earnings.raw_network_maps.reports_mapping)d=year+"-"+pad2(parseInt(ctr))+"-01",console.log(earnings.raw_network_maps.reports_mapping[i].start_date===d),earnings.raw_network_maps.reports_mapping[i].start_date===d&&(reports_to_search+=i+",",earnings.net_earnings[i]=earnings.raw_network_maps.reports_mapping[i]);ctr++}return console.log("   repo",reports_to_search),console.log("   earnings.net_earnings",earnings.net_earnings),earnings.net_earnings}function net_earnings_tochart(earn){var report_data=[["Months","Earnings","Channels"]];for(var c in earn){if("function"==typeof earn[c])break;console.log("earn[c]",earn[c]),report_data.push([get_month(earnings.reports_mapping[earn[c].report_id].start_date),earn[c].earnings,earn[c].channel_count])}return report_data}function details_tochart(data){for(var ch_earnings,revshare,report_data=[["Months","Earnings"]],c=0;c<data.length;c++)ch_earnings=data[c].earnings,revshare=data[c].channel_revshare,report_data[c+1]=[get_month(earnings.reports_mapping[data[c].report_id].start_date),ch_earnings*(revshare/100)];return earnings.detailschart_data=report_data,report_data}function recruiterdetails_tochart(data){var ch_earnings,revshare,report_data=[["Months","Earnings"]];for(var c in data)for(var i=data[c].length-1;i>=0;i--)ch_earnings=data[c][i].earnings,revshare=data[c][i].channel_revshare,report_data.push([get_month(earnings.reports_mapping[c].start_date),ch_earnings*(revshare/100)]);return report_data}function get_recruiter_earnings(reports){return defer=$q.defer(),earnings.raw_recruiter_earnings=localStorageService.get($rootScope.access_token+"recruiter_earnings"),is_empty(earnings.raw_recruiter_earnings)||reports?userearningsService.get_recruiter_earnings(reports).then(function(data){earnings.raw_recruiter_earnings=data,localStorageService.set($rootScope.access_token+"recruiter_earnings",data),defer.resolve(earnings.raw_channel_earnings)},function(data){defer.reject(data)}):defer.resolve(earnings.raw_recruiter_earnings),defer.promise}function get_overall_earnings(reports){return defer=$q.defer(),earnings.raw_overall_earnings=localStorageService.get($rootScope.access_token+"overall_earnings"),console.log("is_empty(earnings.raw_overall_earnings)",is_empty(earnings.raw_overall_earnings)),is_empty(earnings.raw_overall_earnings)&&reports?userearningsService.get_overall_earnings(reports).then(function(data){earnings.raw_overall_earnings=data,localStorageService.set($rootScope.access_token+"overall_earnings",data),overall_chart(earnings.raw_overall_earnings),defer.resolve(earnings.raw_overall_earnings)},function(data){defer.reject(data)}):(overall_chart(earnings.raw_overall_earnings),defer.resolve(earnings.raw_overall_earnings)),defer.promise}function set_list_reports_overall(start,after,year){var d,i,reports_to_search="",diff=start-year,big=diff>0?start:after,small=0>diff?start:after,ctr=small,ch_earnings=earnings.raw_overall_earnings,reports=earnings.reports;for(console.log("   earnings.raw",earnings.raw_overall_earnings),earnings.overall_earnings=[];big>=ctr;){for(i in reports)d=year+"-"+pad2(parseInt(ctr))+"-01",reports[i].start_date===d&&(reports_to_search+=reports[i].id+",",ch_earnings[ch_earnings.objectIndexOf(reports[i].id,"report_id")]&&earnings.overall_earnings.push(ch_earnings[ch_earnings.objectIndexOf(reports[i].id,"report_id")]));ctr++}return console.log("   earnings.overall_earnings",earnings),reports_to_search}function overall_chart(overall_earnings){var report_data=[];earnings.overall={net_earnings:0};for(var c=overall_earnings.length-1;c>=0;c--)overall_earnings[c]&&(report_data.push([get_month(earnings.reports_mapping[overall_earnings[c].report_id].start_date),overall_earnings[c].sum]),earnings.overall.net_earnings+=overall_earnings[c].sum);return report_data.push(["Months","Earnings"]),report_data.reverse()}function pad2(number){return(10>number?"0":"")+number}function get_month(value){return"number"==typeof value?months[value-1]:months[parseInt(value.split("-")[1])-1]+" "+value.split("-")[0]}var defer,months=["January","February","March","April","May","June","July","August","September","October","November","December"],earnings={load:get_reports,get_user_earnings:get_user_earnings,get_raw_reports:get_raw_reports,get_current_earnings:get_current_earnings,get_recruiter_earnings:get_recruiter_earnings,get_channel_earnings:get_channel_earnings,details_tochart:details_tochart,change_reports:change_reports,get_raw_network_earnings:get_raw_network_earnings,get_raw_earnings:get_raw_earnings,search_recruiter_earnings:userearningsService.search_recruiter_earnings,net_earnings_tochart:net_earnings_tochart,get_overall_earnings:get_overall_earnings,get_month:get_month,overall_chart:overall_chart,set_list_reports:set_list_reports,set_list_reports_overall:set_list_reports_overall,recruiterdetails_tochart:recruiterdetails_tochart};return earnings}angular.module("ui.freedom").factory("Earnings",factory),factory.$inject=["userearningsService","networkearningsService","localStorageService","$rootScope","$q"]}(),function(){"use strict";function service(config,$http){function call_range(all){var url=all&&"?all=true"||"";return request=$http({method:"GET",url:config.api_base_url+"/earnings/date_range"+url,headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function get_recruiter_earnings(){return request=$http({method:"GET",url:config.api_base_url+"/earnings/recruits",headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function search_recruiters(key,page,order){var url="?key="+encodeURIComponent(key)+"&page="+page+"&order="+order||"total_views";return request=$http({method:"GET",url:config.api_base_url+"/search_recruits"+url,headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function search_recruiter_earnings(id){return request=$http({method:"GET",url:config.api_base_url+"/earnings/recruits?channel_id="+encodeURIComponent(id),headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function get_report_from_date(list_reports){return list_reports.split(",")&&list_reports.split(",")[0]&&(request=$http({method:"GET",url:config.api_base_url+"/earnings/channels?report_id="+encodeURIComponent(list_reports),headers:config.custom_headers})),request.then(config.handle_success,config.handle_error)}function get_user_earnings(id,list_reports){return console.log("list_reports",list_reports),request=$http({method:"GET",url:config.api_base_url+"/earnings/channels?user_id="+encodeURIComponent(id)+"&report_id="+encodeURIComponent(list_reports),headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}function get_overall_earnings(list_reports){return request=$http({method:"GET",url:config.api_base_url+"/admin/freedom_earnings?report_id="+encodeURIComponent(list_reports),headers:config.custom_headers}),request.then(config.handle_success,config.handle_error)}var request;return{call_range:call_range,get_recruiter_earnings:get_recruiter_earnings,search_recruiters:search_recruiters,search_recruiter_earnings:search_recruiter_earnings,get_report_from_date:get_report_from_date,get_user_earnings:get_user_earnings,get_overall_earnings:get_overall_earnings}}angular.module("rest.userearnings",["rest.config"]).service("userearningsService",service),service.$inject=["config","$http","$q"]}();